@use "abstracts/variables/colors" as *;
@use "abstracts/variables/fonts" as *;

@mixin flap-animation {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  transform: rotateX(270deg); // Hidden perpendicular to screen
  transition: transform 0.5s ease;
  backface-visibility: hidden; // Hides the "back" of the flap [2]
}

.threeLayerButton {
  appearance: none;
  background: $sys-color-paper-bg;
  color: $sys-color-action-primary;
  border: 4px solid $sys-color-ink-text;
  border-radius: 12px;
  padding: 0.75rem 1.5rem;
  font-family: $sys-font-headline;
  font-weight: 700;
  font-size: 1rem;
  letter-spacing: 2px;
  cursor: pointer;
  position: relative;
  text-decoration: none;

  // 3D CORE CONFIG
  transform-style: preserve-3d; // Required for children to rotate in 3D [3]
  overflow: visible;           // CRITICAL: prevents clipping during the flip
  transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);

  &::before {
    @include flap-animation;
    content: attr(data-before);
    background-color: lighten(green, 15%);
    // background-color: lighten($sys-color-action-primary, 15%);
    color: $sys-color-paper-bg;
    transform-origin: top;
  }

  &::after {
    @include flap-animation;
    content: attr(data-after);
    background-color: lighten($sys-color-action-primary, 35%);
    color: $sys-color-ink-text;
    transform-origin: bottom;
    transition-delay: 0.1s;
  }

  &:hover {
    transform: scale(1.05);
    &::before, &::after { transform: rotateX(0deg); } // Reveal flaps
  }
}
